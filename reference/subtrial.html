<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions create one subsampling trial dataset with a desired subsampling method"><title>Subsampling trial functions — subtrialCR • divDyn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Subsampling trial functions — subtrialCR"><meta property="og:description" content="These functions create one subsampling trial dataset with a desired subsampling method"><meta property="og:image" content="https://divDyn.github.io/reference/figures/logo.png"><meta property="og:image:alt" content="The divDyn sticker."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@atkocsis"><meta name="twitter:site" content="@atkocsis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">divDyn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/divDyn_1_installation.html">1. Installation</a>
    <a class="dropdown-item" href="../articles/divDyn_2_handout.html">2. Handout</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-internals">Internals</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-internals">
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.evolv-ed.net/">How-to guides on EvolvED</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/divDyn/divDyn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Subsampling trial functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/divDyn/divDyn/blob/HEAD/R/subtrials.R" class="external-link"><code>R/subtrials.R</code></a></small>
      <div class="d-none name"><code>subtrial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions create one subsampling trial dataset with a desired subsampling method</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">subtrialCR</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">q</span>,</span>
<span>  bin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useFailed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showFailed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">subtrialOXW</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">q</span>,</span>
<span>  bin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coll <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xexp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useFailed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showFailed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">subtrialSQS</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">tax</span>,</span>
<span>  <span class="va">q</span>,</span>
<span>  bin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coll <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  singleton <span class="op">=</span> <span class="st">"occ"</span>,</span>
<span>  excludeDominant <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  largestColl <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fcorr <span class="op">=</span> <span class="st">"good"</span>,</span>
<span>  byList <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useFailed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showFailed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  appr <span class="op">=</span> <span class="st">"under"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>(<code>data.frame</code>): Occurrence dataset, with <code>bin</code>, <code>tax</code> and <code>coll</code> as column names.</p></dd>


<dt>q</dt>
<dd><p>(<code>numeric)</code>: Subsampling level argument (mandatory). Depends on the subsampling function, it is the number of occurrences for <code>"cr"</code>, and the number of desired occurrences to the power of <code>xexp</code> for O^x^W. It is also the quorum of the SQS method.</p></dd>


<dt>bin</dt>
<dd><p>(<code>character</code>): The name of the subsetting variable (has to be integer). For time series, this is the time-slice variable. Rows with <code>NA</code> entries in this column will be omitted.</p></dd>


<dt>unit</dt>
<dd><p>(<code>character</code>): Argument of the CR subsampling type. The name of the variable that designates the subsampling units. In every bin, CR selects a certain number (quota) of entries from the dataset. By default (<code>unit=NULL</code>), the units will be the rows, and the <code>q</code> number of rows will be selected in each bin.
However, this can be a higher level category that has multiple entries in the each bin. If <code>unit</code> is a valid column of the dataset <code>x</code>, then CR will select <code>q</code> number entries in this variable, and will return all the corresponding rows.</p></dd>


<dt>keep</dt>
<dd><p>(<code>numeric</code>): The bins, which will not be subsampled but will be added to the subsampling trials. NIf the number of occurrences does not reach the subsampling quota, by default it will not be represented in the subsampling trials. You can force their inclusion with the <code>keep</code> argument separetely (for all, see the <code>useFailed</code> argument). Only applicable when <code>bin!=NULL</code>.</p></dd>


<dt>useFailed</dt>
<dd><p>(<code>logical</code>): If the bin does not reach the subsampling quota, should the bin be used? If <code>bin!=NULL</code> and <code>useFailed=TRUE</code> then only <code>TRUE</code> values will be output (indicating the use of the full dataset).</p></dd>


<dt>showFailed</dt>
<dd><p>(<code>logical</code>): Toggles the output of the function. If set to <code>TRUE</code> the output will be a list, including both the default output (logical vector of rows) and the <code>numeric</code> vector of bins that did not have enough entries to reach the quota <code>q</code>. Only applicable when <code>bin!=NULL</code>.</p></dd>


<dt>coll</dt>
<dd><p>(<code>character</code>): The variable name of the collection identifiers.</p></dd>


<dt>xexp</dt>
<dd><p>(<code>numeric</code>): Argument of the OxW type. The exponent of by-list subsampling, by default it is 1.</p></dd>


<dt>tax</dt>
<dd><p>(<code>character</code>): The name of the taxon variable.</p></dd>


<dt>ref</dt>
<dd><p>(<code>character</code>): The name of the reference variable, optional - depending on the subsampling method.</p></dd>


<dt>singleton</dt>
<dd><p><code>(character)</code>: A parameter of SQS. Either <code>"ref"</code>, <code>"occ"</code> or <code>FALSE</code>. If set to <code>"occ"</code>, the coverage estimator (e.g. Good's u) will be calculated based on the number of single-occurrence taxa. 
If set to "ref" the number of occurrences belonging to single-reference taxa will be used instead. In case of the inexact algorithm, if set to <code>FALSE</code> then coverage corrections of frequencies will not be applied.</p></dd>


<dt>excludeDominant</dt>
<dd><p><code>(logical)</code>: Argument of SQS. This parameter sets whether the dominant taxon should 
be excluded from all calculations involving frequencies (this is the second correction of Alroy, 2010).</p></dd>


<dt>largestColl</dt>
<dd><p><code>(logical)</code>: Parameter of SQS. This parameter sets whether the occurrences of taxa only ever
 found in the most diverse collection should be excluded from the count of 
single-publication occurrences. (this is the third correction of Alroy, 2010) Note that <code>largestColl=TRUE</code> is dependent on <code>excludeDominant=TRUE</code>. Setting <code>excludeDominant</code> to <code>FALSE</code> will turn this correction off.</p></dd>


<dt>fcorr</dt>
<dd><p><code>(character)</code>: Parameter for the inexact method of SQS. either "good" or "alroy". This argument changes the frequency correction procedure of the 
'inexact' version of SQS (Alroy 2010). As not all taxa are present in the samples, 
the sampled frequencies of taxa tend overestimate their frequencies in the sampling pool. 
In Alroy (2010) these are corrected using Good's u ("good", default), in the later versions 
of SQS this metric is changed to a different method using single occurrence and double occurrence taxa ("alroy").</p></dd>


<dt>byList</dt>
<dd><p>(<code>character</code>): A parameter of the <code>"inexact"</code> method of SQS. Sets whether occurrences should be subsampled with (<code>FALSE</code>) or without (<code>TRUE</code>) breaking the collection integrity.</p></dd>


<dt>appr</dt>
<dd><p>(<code>character</code>): A parameter of the inexact method of SQS. Either "over" (default) or ("under"). The current 
version is not concerned with small fluctuations around the drawn subsampling quorum. 
Therefore, in the inexact algorithm, sampling is finished when the subset 
either is immediately below the quorum (<code>"under"</code>) or above it (<code>"over"</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A logical vector.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The essence of these functions are present within the subsampling wrapper function <code><a href="subsample.html">subsample</a></code>. Each function implements a certain subsampling type.
The return value of the funcfions by default is a <code>logical</code> vector indicating which rows of the original dataset should be present in the subsample. 
The inexact method for SQS is implemented here as it is computationally less demanding.</p>
<p><strong>References:</strong></p>
<p>Alroy, J., Marshall, C. R., Bambach, R. K., Bezusko, K., Foote, M., Fürsich, F. T., … Webber, A. (2001). Effects of sampling standardization on estimates of Phanerozoic marine diversification. Proceedings of the National Academy of Science, 98(11), 6261-6266.</p>
<p>Alroy, J. (2010). The Shifting Balance of Diversity Among Major Marine Animal Groups. Science, 329, 1191-1194. https://doi.org/10.1126/science.1189910</p>
<p>Raup, D. M. (1975). Taxonomic Diversity Estimation Using Rarefaction. Paleobiology, 1, 333-342. https: //doi.org/10.2307/2400135</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#one classical rarefaction trial</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">corals</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># return 5 references for each stage</span></span></span>
<span class="r-in"><span>  <span class="va">bRows</span><span class="op">&lt;-</span><span class="fu">subtrialCR</span><span class="op">(</span><span class="va">corals</span>, bin<span class="op">=</span><span class="st">"stg"</span>, unit<span class="op">=</span><span class="st">"reference_no"</span>, q<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># control</span></span></span>
<span class="r-in"><span>  <span class="va">unCor</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">corals</span><span class="op">[</span><span class="va">bRows</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stg"</span>, <span class="st">"reference_no"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">unCor</span><span class="op">$</span><span class="va">stg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://palaeobiology.nat.fau.de/people/instructors/kocsis/" class="external-link">Adam T. Kocsis</a>, <a href="https://researchers.mq.edu.au/en/persons/john-alroy" class="external-link">John Alroy</a>, <a href="https://www.gzn.nat.fau.eu/palaeontologie/team/former-members/reddin/" class="external-link">Carl J. Reddin</a>, <a href="https://www.gzn.nat.fau.eu/palaeontologie/team/professors/kiessling/" class="external-link">Wolfgang Kiessling</a>, <a href="https://www.dfg.de/en/index.jsp" class="external-link"><img src="https://www.dfg.de/includes/bausteine/open_graph_de/dfgfallback.jpg" alt="dfg" width="80"></a>, <a href="https://www.gzn.nat.fau.eu/" class="external-link"><img src="https://www.gzn.nat.fau.de/files/2017/05/cropped-gzn-logo.jpg" alt="geozentrum" width="80"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

